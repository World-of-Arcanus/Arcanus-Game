<!DOCTYPE html>

<head>
    <meta charset="UTF-8">
</head>

<body>
    <table cellspacing="0" cellpadding="10" align="center">
        <tr>
            <td align="center">
                <select onchange="change(this.value)" autocomplete="off" style="width: 150px">
                    <option value="">Choose Block ...</option>
                </select>
            </td>
        </tr>
        <tr>
            <td width="600" height="600" align="center" style="background: #000000">
                <canvas width="128" height="128" id="cube"></canvas>
            </td>
        </tr>
    <table>
</body>

<script type="module">
    import * as THREE from 'https://cdn.skypack.dev/three@0.132.2';
    
    let camera, mesh, scene;
    
    let canvas = document.getElementById('cube');
    
    let renderer = new THREE.WebGLRenderer({ canvas: canvas, antialias: true });
	renderer.setPixelRatio(window.devicePixelRatio);
	renderer.setSize(canvas.width, canvas.height);
	
    function change(block) {
        if (block == "") { return; }
        
        camera = new THREE.PerspectiveCamera(32, canvas.width / canvas.height, 1, 1000);
		camera.position.z = 400;
        
        const geometry = new THREE.BoxGeometry(128, 128, 128);
        
        const filePath = 'blocks/';
        const fileExt = '.png';
		
		let blockRight  = (blocks[block]['all']) ? blocks[block]['all'] : ((blocks[block]['side']) ? blocks[block]['side'] : blocks[block]['right']);
		let blockLeft   = (blocks[block]['all']) ? blocks[block]['all'] : ((blocks[block]['side']) ? blocks[block]['side'] : blocks[block]['left']);
		let blockBack   = (blocks[block]['all']) ? blocks[block]['all'] : ((blocks[block]['side']) ? blocks[block]['side'] : blocks[block]['back']);
		let blockFront  = (blocks[block]['all']) ? blocks[block]['all'] : ((blocks[block]['side']) ? blocks[block]['side'] : blocks[block]['front']);
		let blockTop    = (blocks[block]['all']) ? blocks[block]['all'] : blocks[block]['top'];
		let blockBottom = (blocks[block]['all']) ? blocks[block]['all'] : blocks[block]['bottom'];
		
		console.log('Changing to ' + filePath + blockFront + fileExt)
		
		let textureLeft = new THREE.TextureLoader().load(filePath + blockLeft + fileExt);
		textureLeft.center = new THREE.Vector2(0.5, 0.5);
        textureLeft.rotation = -(Math.PI / 2);
		
		let material = [
            new THREE.MeshBasicMaterial({
                map: new THREE.TextureLoader().load(filePath + blockRight + fileExt)
            }),
            new THREE.MeshBasicMaterial({
                map: textureLeft
            }),
            new THREE.MeshBasicMaterial({
                map: new THREE.TextureLoader().load(filePath + blockBack + fileExt)
            }),
            new THREE.MeshBasicMaterial({
                map: new THREE.TextureLoader().load(filePath + blockFront + fileExt)
            }),
            new THREE.MeshBasicMaterial({
                map: new THREE.TextureLoader().load(filePath + blockTop + fileExt)
            }),
            new THREE.MeshBasicMaterial({
                map: new THREE.TextureLoader().load(filePath + blockBottom + fileExt)
            })
        ];
        
		mesh = new THREE.Mesh(geometry, material);
		mesh.rotation.x -= 1.0;
		mesh.rotation.z += 0.8;
		
		scene = new THREE.Scene();
		scene.background = new THREE.Color(0x000000);
		scene.add(mesh);

        if (renderer) { renderer.clear(); }
        
		update();
    }
    
    function update() {
		requestAnimationFrame(update);
        renderer.render(scene, camera);
	}
	
	window.change = change;
</script>

<script>
    var blocks = {
        'Adminium': {
            all: 'Adminium'
        },
        'Apples': {
            all: 'Apples'
        },
        'Grass': {
            side: 'GrassSide',
            top: 'Grass',
            bottom: 'Dirt'
        }
    }
    
    let select = document.querySelector('select');
    
    for (block in blocks) {
        let option = document.createElement('option');
        option.value = block;
        
        option.appendChild(document.createTextNode(block));
        select.appendChild(option);
    }
</script>

</html>